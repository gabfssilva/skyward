
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Distributed compute orchestration for ML/AI workloads. Cloud accelerators with a single decorator.">
      
      
      
        <link rel="canonical" href="https://gabfssilva.github.io/skyward/concepts/">
      
      
        <link rel="prev" href="../getting-started/">
      
      
        <link rel="next" href="../providers/">
      
      
        
      
      
      <link rel="icon" href="../logo_sky.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Core concepts - Skyward</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Space+Grotesk:300,300i,400,400i,700,700i%7CSpace+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Space Grotesk";--md-code-font:"Space Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="custom" data-md-color-accent="custom">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#core-concepts" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Skyward" class="md-header__button md-logo" aria-label="Skyward" data-md-component="logo">
      
  <img src="../logo_sky.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Skyward
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Core concepts
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="custom" data-md-color-accent="custom"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="custom"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/gabfssilva/skyward" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    gabfssilva/skyward
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href=".." class="md-tabs__link">
          
  
  
  Home

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../plugins/" class="md-tabs__link">
          
  
  
  Plugins

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../guides/hello-skyward/" class="md-tabs__link">
          
  
  
  Guides

        </a>
      </li>
    
  

    
  

      
        
  
  
  
  
    
    
      
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../reference/pool/" class="md-tabs__link">
          
  
  
  API reference

        </a>
      </li>
    
  

    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Skyward" class="md-nav__button md-logo" aria-label="Skyward" data-md-component="logo">
      
  <img src="../logo_sky.png" alt="logo">

    </a>
    Skyward
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/gabfssilva/skyward" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    gabfssilva/skyward
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" checked>
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Home
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Skyward
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../getting-started/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Getting started
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Core concepts
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Core concepts
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#lazy-computation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Lazy computation
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-pool" class="md-nav__link">
    <span class="md-ellipsis">
      
        The pool
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="The pool">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lifecycle" class="md-nav__link">
    <span class="md-ellipsis">
      
        Lifecycle
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#workers" class="md-nav__link">
    <span class="md-ellipsis">
      
        Workers
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#operators" class="md-nav__link">
    <span class="md-ellipsis">
      
        Operators
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Operators">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#execute-on-one-node" class="md-nav__link">
    <span class="md-ellipsis">
      
        &gt;&gt; — Execute on one node
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#broadcast-to-all-nodes" class="md-nav__link">
    <span class="md-ellipsis">
      
        @ — Broadcast to all nodes
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parallel-composition" class="md-nav__link">
    <span class="md-ellipsis">
      
        &amp; — Parallel composition
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#async-dispatch" class="md-nav__link">
    <span class="md-ellipsis">
      
        &gt; — Async dispatch
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gather-dynamic-parallelism" class="md-nav__link">
    <span class="md-ellipsis">
      
        gather() — Dynamic parallelism
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#image" class="md-nav__link">
    <span class="md-ellipsis">
      
        Image
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#runtime-context" class="md-nav__link">
    <span class="md-ellipsis">
      
        Runtime context
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Runtime context">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#data-sharding" class="md-nav__link">
    <span class="md-ellipsis">
      
        Data sharding
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#streaming" class="md-nav__link">
    <span class="md-ellipsis">
      
        Streaming
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#providers" class="md-nav__link">
    <span class="md-ellipsis">
      
        Providers
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#accelerators" class="md-nav__link">
    <span class="md-ellipsis">
      
        Accelerators
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#allocation-strategies" class="md-nav__link">
    <span class="md-ellipsis">
      
        Allocation strategies
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resource-selection" class="md-nav__link">
    <span class="md-ellipsis">
      
        Resource selection
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Resource selection">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#spec" class="md-nav__link">
    <span class="md-ellipsis">
      
        Spec
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#offers-and-instance-types" class="md-nav__link">
    <span class="md-ellipsis">
      
        Offers and instance types
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#selection-strategies" class="md-nav__link">
    <span class="md-ellipsis">
      
        Selection strategies
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-selection-flow" class="md-nav__link">
    <span class="md-ellipsis">
      
        The selection flow
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#next-steps" class="md-nav__link">
    <span class="md-ellipsis">
      
        Next steps
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_1_4" >
        
          
          <label class="md-nav__link" for="__nav_1_4" id="__nav_1_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Infrastructure
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Infrastructure
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../providers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Providers
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../accelerators/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Accelerators
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../volumes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Volumes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../provision-controllers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Provision controllers
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../why-asyncio/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Why asyncio
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_1_5" >
        
          
          <label class="md-nav__link" for="__nav_1_5" id="__nav_1_5_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Clustering
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Clustering
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Architecture
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../distributed-training/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Distributed training
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../distributed-collections/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Distributed collections
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_1_6" >
        
          
          <label class="md-nav__link" for="__nav_1_6" id="__nav_1_6_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Misc
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Misc
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sky-computing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Sky computing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../hpc/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    For HPC users
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Plugins
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Plugins
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../plugins/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    What are plugins?
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../plugins/torch/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    PyTorch
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../plugins/jax/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    JAX
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../plugins/keras/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Keras
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../plugins/huggingface/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    HuggingFace
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../plugins/joblib/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Joblib
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../plugins/sklearn/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Scikit-learn
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../plugins/cuml/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    cuML
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../plugins/mps/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    NVIDIA MPS
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../plugins/mig/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    NVIDIA MIG
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Guides
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Guides
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_1" >
        
          
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Getting started
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Getting started
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../guides/hello-skyward/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Hello, Skyward!
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../guides/parallel-execution/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Parallel execution
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../guides/broadcast/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Broadcast
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../guides/using-accelerators/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Using accelerators
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../guides/data-sharding/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Data sharding
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../guides/streaming/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Streaming
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../guides/torch-model-roundtrip/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    PyTorch model roundtrip
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Distributed training
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Distributed training
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../guides/pytorch-distributed/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    PyTorch distributed
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../guides/keras-training/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Keras training
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../guides/microgpt-distributed/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    MicroGPT distributed
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../guides/huggingface-finetuning/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    HuggingFace fine-tuning
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Infrastructure
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Infrastructure
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../guides/nvidia-mig/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    NVIDIA MIG
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../guides/s3-volumes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    S3 volumes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../guides/multi-provider/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Multi-provider selection
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_4" >
        
          
          <label class="md-nav__link" for="__nav_3_4" id="__nav_3_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Testing
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Testing
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../guides/local-containers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Local containers
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_5" >
        
          
          <label class="md-nav__link" for="__nav_3_5" id="__nav_3_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Misc
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Misc
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../guides/joblib-concurrency/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Joblib concurrency
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../guides/scikit-grid-search/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Scikit grid search
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../guides/cuml-acceleration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    cuML GPU acceleration
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    API reference
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    API reference
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_1" >
        
          
          <label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Core
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Core
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/pool/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Pool & compute
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/runtime/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Runtime
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/config/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Configuration
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Providers
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Providers
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/providers/aws/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    AWS
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/providers/gcp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    GCP
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/providers/runpod/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    RunPod
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/providers/vastai/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    VastAI
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/providers/verda/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Verda
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/distributed/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Distributed collections
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/events/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Events
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/plugins/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Plugins
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/accelerators/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Accelerators
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#lazy-computation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Lazy computation
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-pool" class="md-nav__link">
    <span class="md-ellipsis">
      
        The pool
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="The pool">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lifecycle" class="md-nav__link">
    <span class="md-ellipsis">
      
        Lifecycle
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#workers" class="md-nav__link">
    <span class="md-ellipsis">
      
        Workers
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#operators" class="md-nav__link">
    <span class="md-ellipsis">
      
        Operators
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Operators">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#execute-on-one-node" class="md-nav__link">
    <span class="md-ellipsis">
      
        &gt;&gt; — Execute on one node
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#broadcast-to-all-nodes" class="md-nav__link">
    <span class="md-ellipsis">
      
        @ — Broadcast to all nodes
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parallel-composition" class="md-nav__link">
    <span class="md-ellipsis">
      
        &amp; — Parallel composition
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#async-dispatch" class="md-nav__link">
    <span class="md-ellipsis">
      
        &gt; — Async dispatch
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gather-dynamic-parallelism" class="md-nav__link">
    <span class="md-ellipsis">
      
        gather() — Dynamic parallelism
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#image" class="md-nav__link">
    <span class="md-ellipsis">
      
        Image
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#runtime-context" class="md-nav__link">
    <span class="md-ellipsis">
      
        Runtime context
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Runtime context">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#data-sharding" class="md-nav__link">
    <span class="md-ellipsis">
      
        Data sharding
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#streaming" class="md-nav__link">
    <span class="md-ellipsis">
      
        Streaming
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#providers" class="md-nav__link">
    <span class="md-ellipsis">
      
        Providers
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#accelerators" class="md-nav__link">
    <span class="md-ellipsis">
      
        Accelerators
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#allocation-strategies" class="md-nav__link">
    <span class="md-ellipsis">
      
        Allocation strategies
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resource-selection" class="md-nav__link">
    <span class="md-ellipsis">
      
        Resource selection
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Resource selection">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#spec" class="md-nav__link">
    <span class="md-ellipsis">
      
        Spec
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#offers-and-instance-types" class="md-nav__link">
    <span class="md-ellipsis">
      
        Offers and instance types
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#selection-strategies" class="md-nav__link">
    <span class="md-ellipsis">
      
        Selection strategies
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-selection-flow" class="md-nav__link">
    <span class="md-ellipsis">
      
        The selection flow
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#next-steps" class="md-nav__link">
    <span class="md-ellipsis">
      
        Next steps
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="core-concepts">Core concepts<a class="headerlink" href="#core-concepts" title="Permanent link">&para;</a></h1>
<p>Skyward's programming model is built on a simple idea: <strong>computation and location should be separate concerns</strong>. You write ordinary Python functions. You decide where they run — on which cloud, on how many machines, on which accelerators — at the call site, not inside the function itself. This separation is what makes the same code work on a laptop, a single GPU, or a cluster of eight H100s.</p>
<p>This page walks through the concepts that make this possible.</p>
<h2 id="lazy-computation">Lazy computation<a class="headerlink" href="#lazy-computation" title="Permanent link">&para;</a></h2>
<p>The central abstraction in Skyward is <code>@sky.compute</code>. It transforms a regular function into a <strong>lazy computation</strong> — calling the function no longer executes it. Instead, it produces a <code>PendingCompute</code> object: a frozen, serializable description of <em>what</em> to compute, without committing to <em>where</em> or <em>when</em>.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">skyward</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sky</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="nd">@sky</span><span class="o">.</span><span class="n">compute</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="k">def</span><span class="w"> </span><span class="nf">train</span><span class="p">(</span><span class="n">epochs</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    <span class="n">model</span> <span class="o">=</span> <span class="n">build_model</span><span class="p">()</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>    <span class="k">return</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">epochs</span><span class="o">=</span><span class="n">epochs</span><span class="p">)</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="n">pending</span> <span class="o">=</span> <span class="n">train</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>   <span class="c1"># nothing runs — returns PendingCompute[float]</span>
</code></pre></div>
<p>In functional programming, this pattern is known as reifying an <strong>effect</strong>. Calling <code>train(10)</code> doesn't produce a result — it produces a <em>description</em> of a computation that, when interpreted, will produce a result. The side effects (provisioning a GPU, transferring data, executing remotely) are not performed at the call site. They are deferred to an interpreter — in this case, the pool and its operators. This is the same idea behind <code>IO</code> in Haskell, <code>Effect</code> in ZIO, or <code>suspend</code> in Kotlin: separating the description of a program from its execution so that the runtime can decide how, where, and when to run it.</p>
<p>Because <code>PendingCompute</code> is a value — not a running process — it can be serialized, sent over the network, and executed on a remote machine. It can also be composed: combined with other computations via <code>&amp;</code>, collected into a <code>gather()</code>, or stored and dispatched later. None of this triggers execution. The program you're building is a data structure that only materializes when you commit to a target with <code>&gt;&gt;</code> or <code>@</code>.</p>
<p>The generic type is preserved throughout — <code>train(10)</code> produces <code>PendingCompute[float]</code>, and dispatching it returns <code>float</code>. Your type checker sees the same types whether the function runs locally or on a remote GPU.</p>
<p>If you need to bypass this and run the original function directly (for testing, debugging, or local profiling), every decorated function exposes the unwrapped version via <code>.local</code>:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="n">result</span> <span class="o">=</span> <span class="n">train</span><span class="o">.</span><span class="n">local</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>  <span class="c1"># executes immediately, returns float</span>
</code></pre></div>
<h2 id="the-pool">The pool<a class="headerlink" href="#the-pool" title="Permanent link">&para;</a></h2>
<p>A <code>ComputePool</code> is a context manager that represents a set of cloud instances with a defined lifecycle. When you enter the block, Skyward provisions the machines, installs dependencies, and establishes connectivity. When you exit — whether normally or through an exception — everything is torn down.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="k">with</span> <span class="n">sky</span><span class="o">.</span><span class="n">ComputePool</span><span class="p">(</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>    <span class="n">provider</span><span class="o">=</span><span class="n">sky</span><span class="o">.</span><span class="n">AWS</span><span class="p">(),</span>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>    <span class="n">accelerator</span><span class="o">=</span><span class="s2">&quot;A100&quot;</span><span class="p">,</span>
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>    <span class="n">nodes</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>    <span class="n">image</span><span class="o">=</span><span class="n">sky</span><span class="o">.</span><span class="n">Image</span><span class="p">(</span><span class="n">pip</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;torch&quot;</span><span class="p">,</span> <span class="s2">&quot;transformers&quot;</span><span class="p">]),</span>
<a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a><span class="p">)</span> <span class="k">as</span> <span class="n">pool</span><span class="p">:</span>
<a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a>    <span class="n">result</span> <span class="o">=</span> <span class="n">train</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">pool</span>
<a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a><span class="c1"># all instances terminated</span>
</code></pre></div>
<p>This is what it means for compute to be <strong>ephemeral</strong>: the infrastructure exists only for the duration of the work. There are no machines to forget about, no environments that drift over time, no idle costs accumulating overnight. The pool's lifetime is the job's lifetime.</p>
<p>This model fits ML workloads naturally. Training runs, fine-tuning jobs, hyperparameter sweeps, batch inference — these are all tasks with a beginning and an end. The pool captures that shape: provision what you need, do the work, release everything.</p>
<h3 id="lifecycle">Lifecycle<a class="headerlink" href="#lifecycle" title="Permanent link">&para;</a></h3>
<p>Behind the <code>with</code> block, the pool orchestrates a hierarchy of components — each with its own lifecycle — to bring a cluster from zero to ready.</p>
<p>Internally, this orchestration is built on the <strong>actor model</strong> — specifically on <a href="https://gabfssilva.github.io/casty/">Casty</a>, a lightweight actor framework for Python. Each component in the hierarchy (pool, node, instance) is an actor: an isolated unit of state that communicates exclusively through messages. There are no shared locks, no thread pools coordinating through mutexes, no callbacks mutating global state. An actor receives a message, decides what to do, and optionally sends messages to other actors. This makes the concurrent lifecycle of multiple nodes and instances — each progressing through their own state machines at different speeds — straightforward to reason about. Both Casty and Skyward are built on top of asyncio, so actors are cheap and message passing doesn't block threads — the system scales to hundreds of nodes without requiring proportional memory or CPU on your laptop.</p>
<p>Despite being fully asynchronous internally, Skyward exposes a <strong>synchronous API</strong>. The asyncio event loop runs in a background daemon thread, and every public method bridges into it via <code>run_coroutine_threadsafe</code>. This means you write normal, blocking Python — <code>result = task() &gt;&gt; pool</code> — while the orchestration underneath remains non-blocking and concurrent.</p>
<p>A <strong>pool</strong> actor manages the overall process: it asks the <strong>provider</strong> (AWS, RunPod, VastAI, etc.) to prepare infrastructure and launch instances. Each launched instance becomes a <strong>node</strong> actor, and each node supervises an <strong>instance</strong> actor that handles the low-level work — polling the cloud API until the machine is running, opening an SSH tunnel, bootstrapping the environment, and starting the worker process.</p>
<p>The full sequence looks like this:</p>
<pre class="mermaid"><code>sequenceDiagram
    participant User
    participant Pool
    participant Provider
    participant Node
    participant Instance

    User-&gt;&gt;Pool: __enter__
    Pool-&gt;&gt;Provider: offers(spec)
    Provider--&gt;&gt;Pool: Offer (selected)
    Pool-&gt;&gt;Provider: prepare(spec, offer)
    Provider--&gt;&gt;Pool: Cluster
    Pool-&gt;&gt;Provider: provision(cluster, N)
    Provider--&gt;&gt;Pool: Instances

    loop for each instance
        Pool-&gt;&gt;Node: Provision
        Node-&gt;&gt;Instance: spawn
        Instance-&gt;&gt;Provider: get_instance() (poll)
        Provider--&gt;&gt;Instance: running + IP
        Instance-&gt;&gt;Instance: SSH tunnel
        Instance-&gt;&gt;Instance: bootstrap environment
        Instance-&gt;&gt;Instance: start worker
        Instance--&gt;&gt;Node: InstanceBecameReady
        Node--&gt;&gt;Pool: NodeBecameReady
    end

    Pool--&gt;&gt;User: pool ready

    User-&gt;&gt;Pool: __exit__
    Pool-&gt;&gt;Provider: terminate + teardown
    Pool--&gt;&gt;User: done</code></pre>
<p>The provider is only involved at the boundaries: preparing infrastructure, launching instances, polling status, and tearing down. Everything in between — SSH, bootstrap, worker startup, cluster formation — is handled by the instance actor, which means the same orchestration logic works identically across all providers.</p>
<p>Node 0 plays a special role: it's the <strong>head node</strong>. Once its instance is ready, it broadcasts its address to all other nodes so they can form a cluster. This is how distributed training frameworks (PyTorch DDP, JAX, etc.) discover each other — and Skyward's plugins (<code>sky.plugins.torch()</code>, <code>sky.plugins.jax()</code>) configure these frameworks using the head node's address automatically.</p>
<p>If a spot instance is preempted, the node detects the loss, notifies the pool, and requests a replacement from the provider. Tasks that were in flight are re-queued. From the user's perspective, the pool self-heals — though of course repeated preemptions will slow things down.</p>
<p>The pool is also the dispatch target for computations. You don't configure job queues or submit YAML — you use Python operators to express how computations should be distributed across the pool's nodes.</p>
<h2 id="workers">Workers<a class="headerlink" href="#workers" title="Permanent link">&para;</a></h2>
<p>Each node in the pool runs a <strong>worker</strong> — a long-lived process that receives serialized tasks, executes them, and sends results back. The <code>Worker</code> dataclass controls two things: how many tasks a node handles concurrently, and which execution backend runs them.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="k">with</span> <span class="n">sky</span><span class="o">.</span><span class="n">ComputePool</span><span class="p">(</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>    <span class="n">provider</span><span class="o">=</span><span class="n">sky</span><span class="o">.</span><span class="n">AWS</span><span class="p">(),</span>
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>    <span class="n">nodes</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>    <span class="n">worker</span><span class="o">=</span><span class="n">sky</span><span class="o">.</span><span class="n">Worker</span><span class="p">(</span><span class="n">concurrency</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span>
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="p">)</span> <span class="k">as</span> <span class="n">pool</span><span class="p">:</span>
<a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a>    <span class="n">result</span> <span class="o">=</span> <span class="n">train</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">pool</span>
</code></pre></div>
<p><code>concurrency</code> sets the number of task slots per node. Total parallelism across the cluster is <code>nodes * concurrency</code> — four nodes with <code>concurrency=2</code> means eight tasks running simultaneously.</p>
<p>The <code>executor</code> field determines <em>how</em> those tasks run. The default is <code>"process"</code>: each task executes in a separate OS process via <code>ProcessPoolExecutor</code>, which means each has its own Python interpreter and its own GIL. CPU-bound Python code saturates all available cores — a 2-vCPU machine with two concurrent tasks reaches 100% utilization. This is the right choice for numerical computation, data transformation, and training loops.</p>
<p>The alternative is <code>"thread"</code>, which runs tasks as threads inside the worker process. Threads share the GIL, so CPU-bound Python code is limited to one core regardless of concurrency. On the same 2-vCPU machine, you'd see ~50% CPU. Threads are the right choice for I/O-bound work (network calls, disk reads) and for C extensions that release the GIL (NumPy, PyTorch inference). Distributed collections (<code>sky.dict()</code>, <code>sky.counter()</code>, etc.) work with both executors.</p>
<p>For a practical comparison with benchmarks, see the <a href="../guides/worker-executors/">Worker Executors</a> guide.</p>
<h2 id="operators">Operators<a class="headerlink" href="#operators" title="Permanent link">&para;</a></h2>
<p>Most distributed computing frameworks require you to express execution through configuration files, job submission APIs, or method calls like <code>pool.submit(fn, args)</code>. Skyward takes a different approach: it uses Python's operator overloading to create a small vocabulary where the syntax itself communicates intent. The expression <code>train(10) &gt;&gt; pool</code> reads as "send this computation to the pool" — and that's exactly what it does.</p>
<p>This works because <code>@sky.compute</code> returns a <code>PendingCompute</code> value, not a result. Operators are defined on <code>PendingCompute</code> (via <code>__rshift__</code>, <code>__matmul__</code>, <code>__and__</code>, <code>__gt__</code>), and each one triggers a different dispatch strategy on the pool. The pool serializes the function and arguments with cloudpickle, sends the payload to the appropriate worker(s) over SSH, waits for the result, deserializes it, and returns it to the caller.</p>
<h3 id="execute-on-one-node"><code>&gt;&gt;</code> — Execute on one node<a class="headerlink" href="#execute-on-one-node" title="Permanent link">&para;</a></h3>
<p>The most common operation. Sends the computation to a single worker and blocks until the result is available:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="n">result</span> <span class="o">=</span> <span class="n">train</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">pool</span>
</code></pre></div>
<p>The pool selects the target node using round-robin scheduling. If you send ten tasks with <code>&gt;&gt;</code>, they'll be distributed evenly across the available nodes. This is the right operator for independent tasks that don't need to run on every node — hyperparameter trials, inference on different inputs, or any embarrassingly parallel workload.</p>
<h3 id="broadcast-to-all-nodes"><code>@</code> — Broadcast to all nodes<a class="headerlink" href="#broadcast-to-all-nodes" title="Permanent link">&para;</a></h3>
<p>Sends the same computation to every node in the pool. Returns a list with one result per node:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="k">with</span> <span class="n">sky</span><span class="o">.</span><span class="n">ComputePool</span><span class="p">(</span><span class="n">provider</span><span class="o">=</span><span class="n">sky</span><span class="o">.</span><span class="n">AWS</span><span class="p">(),</span> <span class="n">nodes</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span> <span class="k">as</span> <span class="n">pool</span><span class="p">:</span>
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>    <span class="c1"># runs on all 4 nodes, returns list of 4 results</span>
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a>    <span class="n">results</span> <span class="o">=</span> <span class="n">initialize_model</span><span class="p">(</span><span class="n">config</span><span class="p">)</span> <span class="o">@</span> <span class="n">pool</span>
</code></pre></div>
<p>Broadcast is the foundation for distributed training patterns. When combined with <code>sky.shard()</code> inside the function, each node receives the full arguments but operates on its own partition of the data. The function body is identical across nodes — the differentiation happens at runtime based on <code>sky.instance_info()</code>.</p>
<p>This is also the natural way to run setup or teardown operations that must happen on every machine: loading a model into GPU memory, warming up a cache, or writing checkpoints to local disk.</p>
<h3 id="parallel-composition"><code>&amp;</code> — Parallel composition<a class="headerlink" href="#parallel-composition" title="Permanent link">&para;</a></h3>
<p>Combines multiple <em>different</em> computations into a group that executes in parallel. Results are returned as a tuple with full type inference:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="p">(</span><span class="n">preprocess</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">train</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">evaluate</span><span class="p">())</span> <span class="o">&gt;&gt;</span> <span class="n">pool</span>
</code></pre></div>
<p>The distinction from broadcast is important: <code>@</code> runs the <em>same</em> function on all nodes, while <code>&amp;</code> runs <em>different</em> functions concurrently. Each computation in the group may go to a different node (round-robin), and the group blocks until all of them complete. The types are preserved individually — if <code>preprocess</code> returns <code>DataFrame</code>, <code>train</code> returns <code>Model</code>, and <code>evaluate</code> returns <code>float</code>, the destructured result is <code>tuple[DataFrame, Model, float]</code>.</p>
<h3 id="async-dispatch"><code>&gt;</code> — Async dispatch<a class="headerlink" href="#async-dispatch" title="Permanent link">&para;</a></h3>
<p>Like <code>&gt;&gt;</code>, but returns a <code>Future[T]</code> immediately instead of blocking. This lets you overlap remote computation with local work:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="n">future</span> <span class="o">=</span> <span class="n">train</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">pool</span>
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="c1"># ... do local work while the remote computation runs ...</span>
<a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a><span class="n">result</span> <span class="o">=</span> <span class="n">future</span><span class="o">.</span><span class="n">result</span><span class="p">()</span>  <span class="c1"># blocks only when you need the result</span>
</code></pre></div>
<p>The <code>Future</code> follows Python's <code>concurrent.futures</code> protocol, so it integrates with existing code that already works with futures — including <code>as_completed()</code>, <code>wait()</code>, and executor patterns.</p>
<h3 id="gather-dynamic-parallelism"><code>gather()</code> — Dynamic parallelism<a class="headerlink" href="#gather-dynamic-parallelism" title="Permanent link">&para;</a></h3>
<p><code>&amp;</code> works when the number of parallel tasks is known at write time. When it isn't — because you're iterating over a dataset, a list of configurations, or any dynamic collection — <code>gather</code> groups an arbitrary number of computations:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="n">tasks</span> <span class="o">=</span> <span class="p">[</span><span class="n">process</span><span class="p">(</span><span class="n">chunk</span><span class="p">)</span> <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">chunks</span><span class="p">]</span>
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="n">results</span> <span class="o">=</span> <span class="n">sky</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="o">*</span><span class="n">tasks</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">pool</span>
</code></pre></div>
<p>Under the hood, <code>gather</code> creates a <code>PendingComputeGroup</code> — the same type that <code>&amp;</code> produces — so the dispatch behavior is identical. The difference is purely syntactic: <code>&amp;</code> is for a fixed set of typed computations, <code>gather</code> is for a dynamic collection.</p>
<p>With <code>stream=True</code>, results are yielded as they complete rather than waiting for all of them. This is useful when tasks have variable duration and you want to start processing results early:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">sky</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="o">*</span><span class="n">tasks</span><span class="p">,</span> <span class="n">stream</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">pool</span><span class="p">:</span>
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>    <span class="n">save</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</code></pre></div>
<p>By default, streaming preserves the original order (the first yielded result corresponds to the first task). With <code>ordered=False</code>, results arrive in completion order — faster overall, but you lose the positional correspondence.</p>
<h2 id="image">Image<a class="headerlink" href="#image" title="Permanent link">&para;</a></h2>
<p>Remote workers start as bare cloud instances — a fresh OS with no Python, no libraries, no knowledge of your project. The <code>Image</code> dataclass describes the full environment that should exist on each worker before any computation runs. It's a declarative specification: you state what you need, and Skyward generates an idempotent bootstrap script that provisions it.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="n">image</span> <span class="o">=</span> <span class="n">sky</span><span class="o">.</span><span class="n">Image</span><span class="p">(</span>
<a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a>    <span class="n">python</span><span class="o">=</span><span class="s2">&quot;3.13&quot;</span><span class="p">,</span>
<a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a>    <span class="n">pip</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;torch&quot;</span><span class="p">,</span> <span class="s2">&quot;numpy&quot;</span><span class="p">,</span> <span class="s2">&quot;transformers&quot;</span><span class="p">],</span>
<a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a>    <span class="n">apt</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;ffmpeg&quot;</span><span class="p">,</span> <span class="s2">&quot;libsndfile1&quot;</span><span class="p">],</span>
<a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a>    <span class="n">env</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;KERAS_BACKEND&quot;</span><span class="p">:</span> <span class="s2">&quot;jax&quot;</span><span class="p">},</span>
<a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a>    <span class="n">includes</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;./my_module/&quot;</span><span class="p">],</span>
<a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a><span class="p">)</span>
<a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a>
<a id="__codelineno-10-9" name="__codelineno-10-9" href="#__codelineno-10-9"></a><span class="k">with</span> <span class="n">sky</span><span class="o">.</span><span class="n">ComputePool</span><span class="p">(</span><span class="n">provider</span><span class="o">=</span><span class="n">sky</span><span class="o">.</span><span class="n">AWS</span><span class="p">(),</span> <span class="n">image</span><span class="o">=</span><span class="n">image</span><span class="p">)</span> <span class="k">as</span> <span class="n">pool</span><span class="p">:</span>
<a id="__codelineno-10-10" name="__codelineno-10-10" href="#__codelineno-10-10"></a>    <span class="o">...</span>
</code></pre></div>
<p>Each field maps to a phase of the bootstrap process:</p>
<ul>
<li><code>python</code> — The Python version to install. Defaults to <code>"auto"</code>, which detects your local version and matches it on the worker. Workers use <code>uv</code> as the package manager, so installation is fast.</li>
<li><code>pip</code> — Python packages to install in the worker's virtual environment.</li>
<li><code>apt</code> — System-level packages installed before Python setup.</li>
<li><code>env</code> — Environment variables set before your function executes. Useful for framework configuration (<code>KERAS_BACKEND</code>, <code>HF_TOKEN</code>, etc.).</li>
<li><code>includes</code> — Local directories to sync to the workers via SSH. This is how your own code reaches the remote machines without being published as a package.</li>
<li><code>excludes</code> — Glob patterns to skip during sync (e.g., <code>["__pycache__", "*.pyc"]</code>).</li>
</ul>
<p>The bootstrap script is generated once and runs identically on every instance. Because the <code>Image</code> is a frozen dataclass, two pools created with the same image produce the same environment — same Python version, same packages, same system dependencies. This is reproducibility without Docker: the environment specification lives in your Python code, versioned alongside your experiments.</p>
<p>There's also <code>skyward_source</code>, which controls how Skyward itself reaches the workers. In most cases the default <code>"auto"</code> is what you want: it detects whether you're running from an editable install (development mode) and, if so, copies your local Skyward source to the workers instead of installing from PyPI. This means changes to Skyward's own code are reflected immediately on remote machines during development, without publishing a new version.</p>
<h2 id="runtime-context">Runtime context<a class="headerlink" href="#runtime-context" title="Permanent link">&para;</a></h2>
<p>Skyward operates in two worlds. The <strong>client side</strong> is your local machine — where <code>ComputePool</code> runs, where operators dispatch tasks, where results come back. The <strong>worker side</strong> is the remote instance — where your <code>@sky.compute</code> function actually executes. These are separate processes on separate machines, connected by SSH tunnels.</p>
<p>Inside a <code>@sky.compute</code> function, you're in the worker world. The function has access to the remote machine's resources (GPUs, local disk, network), but it doesn't have a reference to the pool object or the client's memory. What it does have is <code>sky.instance_info()</code>: a view of the cluster topology from this node's perspective.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="nd">@sky</span><span class="o">.</span><span class="n">compute</span>
<a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="k">def</span><span class="w"> </span><span class="nf">distributed_task</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
<a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a>    <span class="n">info</span> <span class="o">=</span> <span class="n">sky</span><span class="o">.</span><span class="n">instance_info</span><span class="p">()</span>
<a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Node </span><span class="si">{</span><span class="n">info</span><span class="o">.</span><span class="n">node</span><span class="si">}</span><span class="s2"> of </span><span class="si">{</span><span class="n">info</span><span class="o">.</span><span class="n">total_nodes</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a>
<a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a>    <span class="k">if</span> <span class="n">info</span><span class="o">.</span><span class="n">is_head</span><span class="p">:</span>
<a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a>        <span class="n">coordinate_others</span><span class="p">()</span>
<a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a>    <span class="k">return</span> <span class="n">process</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</code></pre></div>
<p><code>InstanceInfo</code> is populated from a <code>COMPUTE_POOL</code> environment variable that Skyward injects before starting the worker process. It contains the node's index (<code>node</code>), the total cluster size (<code>total_nodes</code>), whether this is the head node (<code>is_head</code>), the head node's address and port (for coordination protocols), the number of accelerators on this node, and a list of all peers with their private IPs.</p>
<p>This is the same mechanism that Skyward's plugins use internally. The <code>torch</code> plugin, for example, reads <code>instance_info()</code> to configure <code>MASTER_ADDR</code>, <code>WORLD_SIZE</code>, and <code>RANK</code> before calling <code>init_process_group</code>. You don't need plugins to access this information — <code>instance_info()</code> is always available inside any <code>@sky.compute</code> function, whether you're using a plugin or writing raw distributed logic.</p>
<h3 id="data-sharding">Data sharding<a class="headerlink" href="#data-sharding" title="Permanent link">&para;</a></h3>
<p>A common pattern in distributed computing is to send the <em>same function</em> to all nodes but have each node operate on a <em>different slice</em> of the data. <code>sky.shard()</code> automates this: it reads the current node's position from <code>instance_info()</code> and returns only the portion of the data that belongs to this node.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="nd">@sky</span><span class="o">.</span><span class="n">compute</span>
<a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a><span class="k">def</span><span class="w"> </span><span class="nf">process</span><span class="p">(</span><span class="n">full_dataset</span><span class="p">):</span>
<a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a>    <span class="n">local_data</span> <span class="o">=</span> <span class="n">sky</span><span class="o">.</span><span class="n">shard</span><span class="p">(</span><span class="n">full_dataset</span><span class="p">)</span>
<a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a>    <span class="k">return</span> <span class="n">analyze</span><span class="p">(</span><span class="n">local_data</span><span class="p">)</span>
<a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a>
<a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a><span class="k">with</span> <span class="n">sky</span><span class="o">.</span><span class="n">ComputePool</span><span class="p">(</span><span class="n">provider</span><span class="o">=</span><span class="n">sky</span><span class="o">.</span><span class="n">AWS</span><span class="p">(),</span> <span class="n">nodes</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span> <span class="k">as</span> <span class="n">pool</span><span class="p">:</span>
<a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a>    <span class="c1"># each node gets 1/4 of the data</span>
<a id="__codelineno-12-8" name="__codelineno-12-8" href="#__codelineno-12-8"></a>    <span class="n">results</span> <span class="o">=</span> <span class="n">process</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span> <span class="o">@</span> <span class="n">pool</span>
</code></pre></div>
<p>The function receives the <em>full</em> dataset as an argument — the serialization cost is paid once — but each node only processes its shard. The sharding algorithm uses modulo striding by default (<code>indices[node::total_nodes]</code>), which distributes elements evenly regardless of whether the total is divisible by the node count.</p>
<p>Sharding is type-preserving: lists produce lists, tuples produce tuples, NumPy arrays produce arrays, PyTorch tensors produce tensors. This means you can shard a tensor and immediately pass it to a model without type conversions.</p>
<p>When sharding multiple arrays, indices are aligned — the same positions are selected from each array, so paired data (features and labels, inputs and targets) stays consistent:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="nd">@sky</span><span class="o">.</span><span class="n">compute</span>
<a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a><span class="k">def</span><span class="w"> </span><span class="nf">train</span><span class="p">(</span><span class="n">x_full</span><span class="p">,</span> <span class="n">y_full</span><span class="p">):</span>
<a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a>    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">sky</span><span class="o">.</span><span class="n">shard</span><span class="p">(</span><span class="n">x_full</span><span class="p">,</span> <span class="n">y_full</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a>    <span class="c1"># x[i] still corresponds to y[i]</span>
<a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a>    <span class="k">return</span> <span class="n">fit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</code></pre></div>
<p>The <code>shuffle</code> parameter randomizes the order before sharding, with a fixed <code>seed</code> ensuring all nodes agree on the same permutation. <code>drop_last=True</code> switches from striding to contiguous blocks and discards leftover elements, guaranteeing equal shard sizes — useful when your training loop requires fixed batch dimensions.</p>
<h2 id="streaming">Streaming<a class="headerlink" href="#streaming" title="Permanent link">&para;</a></h2>
<p>The patterns above — <code>&gt;&gt;</code>, <code>@</code>, <code>&amp;</code>, <code>gather</code> — all follow the same shape: serialize the function and arguments, ship them to a worker, execute, serialize the result, ship it back. The full result materializes on the worker before anything crosses the network. For most workloads this is fine. But some computations produce results incrementally — a training loop that yields metrics every epoch, a data pipeline that emits rows one at a time, a search that finds matches progressively. Waiting for the entire result before returning anything wastes time and memory.</p>
<p>Streaming changes this. If a <code>@sky.compute</code> function is a generator — it uses <code>yield</code> instead of <code>return</code> — Skyward streams the values back to the caller as they're produced. The dispatch expression <code>task() &gt;&gt; pool</code> returns a synchronous iterator instead of a single value, and each element arrives as soon as the worker yields it:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="nd">@sky</span><span class="o">.</span><span class="n">compute</span>
<a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a><span class="k">def</span><span class="w"> </span><span class="nf">generate_samples</span><span class="p">(</span><span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
<a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a>        <span class="k">yield</span> <span class="n">expensive_sample</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a>
<a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a><span class="k">with</span> <span class="n">sky</span><span class="o">.</span><span class="n">ComputePool</span><span class="p">(</span><span class="n">provider</span><span class="o">=</span><span class="n">sky</span><span class="o">.</span><span class="n">AWS</span><span class="p">(),</span> <span class="n">nodes</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="k">as</span> <span class="n">pool</span><span class="p">:</span>
<a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a>    <span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="n">generate_samples</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">pool</span><span class="p">:</span>
<a id="__codelineno-14-8" name="__codelineno-14-8" href="#__codelineno-14-8"></a>        <span class="n">save</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>  <span class="c1"># processes each sample as it arrives</span>
</code></pre></div>
<p>The inverse also works: parameters annotated with <code>Iterator[T]</code> are streamed <em>to</em> the worker instead of being serialized as a single blob. This means a 10GB dataset doesn't need to fit in a single cloudpickle payload — it flows to the worker element by element, and the worker consumes it as a regular <code>for</code> loop:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">collections.abc</span><span class="w"> </span><span class="kn">import</span> <span class="n">Iterator</span>
<a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a>
<a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a><span class="nd">@sky</span><span class="o">.</span><span class="n">compute</span>
<a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a><span class="k">def</span><span class="w"> </span><span class="nf">process</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">Iterator</span><span class="p">[</span><span class="nb">dict</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a>    <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a>    <span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
<a id="__codelineno-15-7" name="__codelineno-15-7" href="#__codelineno-15-7"></a>        <span class="n">transform</span><span class="p">(</span><span class="n">record</span><span class="p">)</span>
<a id="__codelineno-15-8" name="__codelineno-15-8" href="#__codelineno-15-8"></a>        <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-15-9" name="__codelineno-15-9" href="#__codelineno-15-9"></a>    <span class="k">return</span> <span class="n">count</span>
<a id="__codelineno-15-10" name="__codelineno-15-10" href="#__codelineno-15-10"></a>
<a id="__codelineno-15-11" name="__codelineno-15-11" href="#__codelineno-15-11"></a><span class="n">result</span> <span class="o">=</span> <span class="n">process</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">huge_dataset</span><span class="p">))</span> <span class="o">&gt;&gt;</span> <span class="n">pool</span>
</code></pre></div>
<p>Both directions can be combined: a function that takes an <code>Iterator</code> input and yields results creates a bidirectional stream — data flows in, transformed results flow out, and neither side buffers the full dataset in memory.</p>
<p>Under the hood, streaming is built on Casty's <code>stream_producer</code> and <code>stream_consumer</code> actors, which provide backpressure-aware message passing over the SSH-tunneled TCP connection. If the consumer falls behind, the producer pauses automatically. The detection is fully implicit: Skyward inspects the function at dispatch time — if it's a generator, it wraps the output in a stream; if a parameter has an <code>Iterator[T]</code> annotation, it wraps the argument in an input stream. No configuration, no special classes.</p>
<p>For a practical walkthrough with code examples, see the <a href="../guides/streaming/">Streaming</a> guide.</p>
<h2 id="providers">Providers<a class="headerlink" href="#providers" title="Permanent link">&para;</a></h2>
<p>Throughout this page, the <code>provider</code> parameter has appeared in every <code>ComputePool</code> example — <code>sky.AWS()</code>, <code>sky.RunPod()</code>, <code>sky.VastAI()</code>, <code>sky.Verda()</code>, <code>sky.Container()</code>. The provider is the bridge between Skyward's orchestration model and a specific cloud's API. It knows how to translate abstract requests ("I need 4 machines with A100 GPUs") into the concrete API calls that each cloud requires.</p>
<p>All providers implement the same protocol — <code>Provider[C, S]</code> — which defines six operations that map directly to the pool lifecycle discussed earlier:</p>
<ul>
<li><code>offers(spec)</code> — Query available machine types and pricing that match the spec. Returns an async iterator of <code>Offer</code> objects — normalized descriptions of hardware and pricing that can be compared across providers. This is what enables cross-provider selection.</li>
<li><code>prepare(spec, offer)</code> — Set up cluster-level infrastructure for the selected offer: register SSH keys, create VPCs and security groups (AWS), resolve GPU types, configure overlay networks. Returns an immutable <code>Cluster</code> context that flows through all subsequent calls.</li>
<li><code>provision(cluster, count)</code> — Launch the requested number of instances. Returns them in a "provisioning" state — the machines exist, but may not be running yet.</li>
<li><code>get_instance(cluster, id)</code> — Poll the status of a single instance. The instance actor calls this repeatedly until the machine is running and has an IP address.</li>
<li><code>terminate(cluster, ids)</code> — Destroy specific instances.</li>
<li><code>teardown(cluster)</code> — Clean up everything <code>prepare</code> created: delete security groups, deregister keys, remove temporary infrastructure.</li>
</ul>
<p>This protocol is what makes the orchestration layer provider-agnostic. The pool actor, node actors, and instance actors don't know whether they're talking to AWS, RunPod, or a local Docker daemon — they only know the six methods above. Adding a new cloud provider means implementing this protocol; nothing else in the system needs to change.</p>
<p>Provider configs (<code>sky.AWS()</code>, <code>sky.RunPod()</code>, etc.) are deliberately lightweight. They're plain dataclasses that hold configuration — region, credentials path, API keys — but don't import any cloud SDK at module level. The actual SDK (<code>boto3</code>, <code>aioboto3</code>, RunPod's GraphQL client, etc.) is loaded lazily when <code>create_provider()</code> is called at pool start. This means <code>import skyward</code> stays fast regardless of which providers are installed, and you only pay the import cost for the provider you're actually using.</p>
<p>For details on configuring each provider, see the <a href="../providers/">Providers</a> page.</p>
<h2 id="accelerators">Accelerators<a class="headerlink" href="#accelerators" title="Permanent link">&para;</a></h2>
<p>The <code>accelerator</code> parameter on <code>ComputePool</code> tells the provider what hardware you need. You can pass a plain string (<code>"A100"</code>) or use the typed factory functions under <code>sky.accelerators</code>, which provide IDE autocomplete and carry catalog metadata like VRAM size and CUDA compatibility:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="c1"># String — simple, works everywhere</span>
<a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a><span class="n">sky</span><span class="o">.</span><span class="n">ComputePool</span><span class="p">(</span><span class="n">provider</span><span class="o">=</span><span class="n">sky</span><span class="o">.</span><span class="n">AWS</span><span class="p">(),</span> <span class="n">accelerator</span><span class="o">=</span><span class="s2">&quot;A100&quot;</span><span class="p">)</span>
<a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a>
<a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a><span class="c1"># Factory function — type-safe, with defaults from the catalog</span>
<a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a><span class="n">sky</span><span class="o">.</span><span class="n">ComputePool</span><span class="p">(</span><span class="n">provider</span><span class="o">=</span><span class="n">sky</span><span class="o">.</span><span class="n">AWS</span><span class="p">(),</span> <span class="n">accelerator</span><span class="o">=</span><span class="n">sky</span><span class="o">.</span><span class="n">accelerators</span><span class="o">.</span><span class="n">A100</span><span class="p">())</span>
<a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a><span class="n">sky</span><span class="o">.</span><span class="n">ComputePool</span><span class="p">(</span><span class="n">provider</span><span class="o">=</span><span class="n">sky</span><span class="o">.</span><span class="n">AWS</span><span class="p">(),</span> <span class="n">accelerator</span><span class="o">=</span><span class="n">sky</span><span class="o">.</span><span class="n">accelerators</span><span class="o">.</span><span class="n">H100</span><span class="p">(</span><span class="n">count</span><span class="o">=</span><span class="mi">4</span><span class="p">))</span>
<a id="__codelineno-16-7" name="__codelineno-16-7" href="#__codelineno-16-7"></a><span class="n">sky</span><span class="o">.</span><span class="n">ComputePool</span><span class="p">(</span><span class="n">provider</span><span class="o">=</span><span class="n">sky</span><span class="o">.</span><span class="n">AWS</span><span class="p">(),</span> <span class="n">accelerator</span><span class="o">=</span><span class="n">sky</span><span class="o">.</span><span class="n">accelerators</span><span class="o">.</span><span class="n">A100</span><span class="p">(</span><span class="n">memory</span><span class="o">=</span><span class="s2">&quot;40GB&quot;</span><span class="p">))</span>
</code></pre></div>
<p>Both forms produce an <code>Accelerator</code> dataclass — a frozen, immutable specification with <code>name</code>, <code>memory</code>, <code>count</code>, and optional <code>metadata</code>. The factory functions look up defaults from an internal catalog (VRAM sizes, CUDA versions, form factors), so <code>sky.accelerators.H100()</code> already knows it has 80GB of memory without you specifying it.</p>
<p>The recommended approach is the factory function (<code>sky.accelerators.A100()</code>), not the string. If an accelerator isn't available as a factory, it means Skyward hasn't mapped it yet — and that mapping matters. Each cloud provider uses its own naming conventions and instance type structures: an "A100" on AWS is a <code>p4d.24xlarge</code>, on RunPod it's a pod with a specific <code>gpuTypeId</code>, on VastAI it's a marketplace offer filtered by GPU model. The translation from a logical accelerator name to a provider-specific resource isn't a simple string match — it involves resolving instance types, memory variants, multi-GPU configurations, and availability constraints. The catalog centralizes this complexity so that <code>sky.accelerators.A100(count=4)</code> resolves correctly on any provider that supports it.</p>
<p>The catalog covers NVIDIA datacenter GPUs (H100, H200, A100, L40S, T4, etc.), consumer cards (RTX 4090 down to GTX 1060), AMD Instinct (MI300X, MI250X), AWS Trainium and Inferentia, Habana Gaudi, and Google TPUs.</p>
<p>For a complete list, see the <a href="../accelerators/">Accelerators</a> page.</p>
<h2 id="allocation-strategies">Allocation strategies<a class="headerlink" href="#allocation-strategies" title="Permanent link">&para;</a></h2>
<p>Cloud providers offer different pricing models for the same hardware. The most important distinction is between <strong>on-demand</strong> instances (guaranteed availability, full price) and <strong>spot</strong> instances (surplus capacity sold at a discount, but reclaimable by the provider with short notice).</p>
<p>Skyward exposes this as an <code>allocation</code> parameter on the pool:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="c1"># Try spot instances first, fall back to on-demand if unavailable (default)</span>
<a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a><span class="n">sky</span><span class="o">.</span><span class="n">ComputePool</span><span class="p">(</span><span class="n">allocation</span><span class="o">=</span><span class="s2">&quot;spot-if-available&quot;</span><span class="p">)</span>
<a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a>
<a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a><span class="c1"># Always use spot — cheaper, but can be interrupted</span>
<a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a><span class="n">sky</span><span class="o">.</span><span class="n">ComputePool</span><span class="p">(</span><span class="n">allocation</span><span class="o">=</span><span class="s2">&quot;spot&quot;</span><span class="p">)</span>
<a id="__codelineno-17-6" name="__codelineno-17-6" href="#__codelineno-17-6"></a>
<a id="__codelineno-17-7" name="__codelineno-17-7" href="#__codelineno-17-7"></a><span class="c1"># Always on-demand — more expensive, but guaranteed availability</span>
<a id="__codelineno-17-8" name="__codelineno-17-8" href="#__codelineno-17-8"></a><span class="n">sky</span><span class="o">.</span><span class="n">ComputePool</span><span class="p">(</span><span class="n">allocation</span><span class="o">=</span><span class="s2">&quot;on-demand&quot;</span><span class="p">)</span>
<a id="__codelineno-17-9" name="__codelineno-17-9" href="#__codelineno-17-9"></a>
<a id="__codelineno-17-10" name="__codelineno-17-10" href="#__codelineno-17-10"></a><span class="c1"># Compare all options and pick the cheapest</span>
<a id="__codelineno-17-11" name="__codelineno-17-11" href="#__codelineno-17-11"></a><span class="n">sky</span><span class="o">.</span><span class="n">ComputePool</span><span class="p">(</span><span class="n">allocation</span><span class="o">=</span><span class="s2">&quot;cheapest&quot;</span><span class="p">)</span>
</code></pre></div>
<p>Spot instances are typically 60-90% cheaper than on-demand. The trade-off is that the cloud provider can reclaim them with short notice. For fault-tolerant workloads — checkpointed training, idempotent batch jobs, embarrassingly parallel inference — spot is a practical default. For time-sensitive or non-resumable work, on-demand is the safer choice.</p>
<p>The default <code>"spot-if-available"</code> tries to get the best of both: it requests spot capacity first and falls back to on-demand if none is available. This means your pool always starts, even during periods of high spot demand, without requiring you to handle the fallback logic yourself.</p>
<h2 id="resource-selection">Resource selection<a class="headerlink" href="#resource-selection" title="Permanent link">&para;</a></h2>
<p>The previous sections described choosing a single provider and a single allocation strategy. But accelerator availability and pricing vary across providers and change constantly. An A100 on VastAI might cost $1.50/hr right now while the same accelerator on AWS is $3.00/hr — or VastAI might have no capacity at all. Skyward's resource selection system lets you describe multiple hardware preferences and let the system find the best option.</p>
<h3 id="spec">Spec<a class="headerlink" href="#spec" title="Permanent link">&para;</a></h3>
<p>A <code>Spec</code> is a frozen dataclass that bundles a provider with hardware preferences into a single, composable unit:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="n">sky</span><span class="o">.</span><span class="n">Spec</span><span class="p">(</span>
<a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a>    <span class="n">provider</span><span class="o">=</span><span class="n">sky</span><span class="o">.</span><span class="n">VastAI</span><span class="p">(),</span>
<a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a>    <span class="n">accelerator</span><span class="o">=</span><span class="s2">&quot;A100&quot;</span><span class="p">,</span>
<a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a>    <span class="n">nodes</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
<a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a>    <span class="n">allocation</span><span class="o">=</span><span class="s2">&quot;spot&quot;</span><span class="p">,</span>
<a id="__codelineno-18-6" name="__codelineno-18-6" href="#__codelineno-18-6"></a>    <span class="n">max_hourly_cost</span><span class="o">=</span><span class="mf">2.50</span><span class="p">,</span>
<a id="__codelineno-18-7" name="__codelineno-18-7" href="#__codelineno-18-7"></a><span class="p">)</span>
</code></pre></div>
<p>It carries the same fields you'd normally pass to <code>ComputePool</code> — <code>accelerator</code>, <code>nodes</code>, <code>vcpus</code>, <code>memory_gb</code>, <code>architecture</code>, <code>allocation</code>, <code>region</code>, <code>max_hourly_cost</code>, <code>ttl</code> — but scoped to a specific provider. <code>ComputePool</code> accepts multiple <code>Spec</code> objects as positional arguments:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="k">with</span> <span class="n">sky</span><span class="o">.</span><span class="n">ComputePool</span><span class="p">(</span>
<a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a>    <span class="n">sky</span><span class="o">.</span><span class="n">Spec</span><span class="p">(</span><span class="n">provider</span><span class="o">=</span><span class="n">sky</span><span class="o">.</span><span class="n">VastAI</span><span class="p">(),</span> <span class="n">accelerator</span><span class="o">=</span><span class="s2">&quot;A100&quot;</span><span class="p">),</span>
<a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a>    <span class="n">sky</span><span class="o">.</span><span class="n">Spec</span><span class="p">(</span><span class="n">provider</span><span class="o">=</span><span class="n">sky</span><span class="o">.</span><span class="n">AWS</span><span class="p">(),</span> <span class="n">accelerator</span><span class="o">=</span><span class="s2">&quot;A100&quot;</span><span class="p">),</span>
<a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a>    <span class="n">selection</span><span class="o">=</span><span class="s2">&quot;cheapest&quot;</span><span class="p">,</span>
<a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a><span class="p">)</span> <span class="k">as</span> <span class="n">pool</span><span class="p">:</span>
<a id="__codelineno-19-6" name="__codelineno-19-6" href="#__codelineno-19-6"></a>    <span class="n">result</span> <span class="o">=</span> <span class="n">train</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">pool</span>
</code></pre></div>
<p>The single-provider form still works — <code>ComputePool(provider=sky.AWS(), accelerator="A100")</code> internally creates a single <code>Spec</code> and wraps it in a tuple.</p>
<h3 id="offers-and-instance-types">Offers and instance types<a class="headerlink" href="#offers-and-instance-types" title="Permanent link">&para;</a></h3>
<p>Cross-provider comparison requires a common representation of what each provider offers. Skyward models this with two types:</p>
<ul>
<li><strong><code>InstanceType</code></strong> — A normalized, cacheable hardware description: machine name, accelerator, vCPUs, memory, architecture. This is the same across spot and on-demand pricing for the same machine.</li>
<li><strong><code>Offer</code></strong> — Ephemeral pricing and availability on top of an <code>InstanceType</code>: spot price, on-demand price, billing unit (second, minute, or hour). Each provider's <code>offers()</code> method yields <code>Offer</code> objects for a given spec.</li>
</ul>
<p>Because different providers produce structurally identical <code>Offer</code> objects, Skyward can compare an AWS <code>p4d.24xlarge</code> against a VastAI marketplace listing against a Verda H100 — all as normalized offers with comparable prices.</p>
<h3 id="selection-strategies">Selection strategies<a class="headerlink" href="#selection-strategies" title="Permanent link">&para;</a></h3>
<p>The <code>selection</code> parameter on <code>ComputePool</code> controls how Skyward chooses among the offers from multiple specs:</p>
<ul>
<li><strong><code>"cheapest"</code></strong> (default) — Queries all specs, collects all available offers, and picks the one with the lowest price. Best when you want cost optimization and don't have a strong provider preference.</li>
<li><strong><code>"first"</code></strong> — Tries specs in the order you listed them, and stops at the first provider with available offers. Best when you have a preferred provider and want deterministic fallback.</li>
</ul>
<h3 id="the-selection-flow">The selection flow<a class="headerlink" href="#the-selection-flow" title="Permanent link">&para;</a></h3>
<p>Before provisioning anything, <code>ComputePool</code> runs a selection phase to determine where to provision:</p>
<pre class="mermaid"><code>sequenceDiagram
    participant User
    participant Pool
    participant Provider A
    participant Provider B

    User-&gt;&gt;Pool: __enter__

    Pool-&gt;&gt;Provider A: offers(spec_a)
    Provider A--&gt;&gt;Pool: Offer[]
    Pool-&gt;&gt;Provider B: offers(spec_b)
    Provider B--&gt;&gt;Pool: Offer[]

    Pool-&gt;&gt;Pool: select best offer

    Pool-&gt;&gt;Provider B: prepare(spec, offer)
    Provider B--&gt;&gt;Pool: Cluster
    Pool-&gt;&gt;Provider B: provision(cluster, N)
    Note over Pool,Provider B: (lifecycle continues as usual)</code></pre>
<p>The key insight is that offer querying is fast (API calls to check availability and pricing) while provisioning is slow (launching machines). By querying all providers before committing to one, Skyward makes an informed decision without wasting time on failed provisioning attempts.</p>
<p>For a practical walkthrough with code examples, see the <a href="../guides/multi-provider/">Multi-Provider Selection</a> guide.</p>
<h2 id="next-steps">Next steps<a class="headerlink" href="#next-steps" title="Permanent link">&para;</a></h2>
<ul>
<li><strong><a href="../getting-started/">Getting Started</a></strong> — Installation, credentials, and first example</li>
<li><strong><a href="../distributed-training/">Distributed Training</a></strong> — Multi-node training with PyTorch, Keras, and JAX</li>
<li><strong><a href="../providers/">Providers</a></strong> — AWS, GCP, RunPod, VastAI, and Verda</li>
<li><strong><a href="../distributed-collections/">Distributed Collections</a></strong> — Shared state across nodes</li>
<li><strong><a href="../guides/streaming/">Streaming</a></strong> — Incremental input and output with generators</li>
<li><strong><a href="../guides/multi-provider/">Multi-Provider Selection</a></strong> — Cross-provider price comparison</li>
<li><strong><a href="../reference/pool/">API Reference</a></strong> — Complete API documentation</li>
</ul>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "..", "features": ["navigation.tabs", "navigation.sections", "navigation.expand", "navigation.top", "search.highlight", "content.code.copy"], "search": "../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.79ae519e.min.js"></script>
      
    
  </body>
</html>